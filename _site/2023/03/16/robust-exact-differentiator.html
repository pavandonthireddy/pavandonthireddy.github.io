<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Robust Exact Differentiator" /><meta property="og:locale" content="en_US" /><meta name="description" content="Robust Exact Differentiator" /><meta property="og:description" content="Robust Exact Differentiator" /><link rel="canonical" href="http://localhost:4000/2023/03/16/robust-exact-differentiator" /><meta property="og:url" content="http://localhost:4000/2023/03/16/robust-exact-differentiator" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-16T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Robust Exact Differentiator" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-16T00:00:00+00:00","datePublished":"2023-03-16T00:00:00+00:00","description":"Robust Exact Differentiator","headline":"Robust Exact Differentiator","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/03/16/robust-exact-differentiator"},"url":"http://localhost:4000/2023/03/16/robust-exact-differentiator"}</script><title> Robust Exact Differentiator - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/03/16/robust-exact-differentiator" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="A robust exact differentiator is a type of differentiation algorithm that provides an exact estimate of the derivative of a signal, while being robust to noi..."><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="A robust exact differentiator is a type of differentiation algorithm that provides an exact estimate of the derivative of a signal, while being robust to noi..."/><meta property="og:title" content="Robust Exact Differentiator"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-03-16T00:00:00+00:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/03/16/robust-exact-differentiator" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <!--KaTeX--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script> <script> document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, { // ...options... }); }); </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><section class="post"><h1 style="text-align: center;">Robust Exact Differentiator</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-03-16T00:00:00+00:00">March 16, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/numerical_differentiaton">numerical_differentiaton</a>, <a href="/tag/trend_estimation">trend_estimation</a>, <a href="/tag/differentiator">differentiator</a>, <a href="/tag/loss_function">loss_function</a></span></div><p>A robust exact differentiator is a type of differentiation algorithm that provides an exact estimate of the derivative of a signal, while being robust to noise and outliers in the signal.</p><p>The basic idea behind a robust exact differentiator is to estimate the derivative of a signal by fitting a polynomial curve to the signal, and then differentiating the polynomial function. The order of the polynomial is chosen to match the degree of smoothness of the signal. For example, if the signal is a smooth curve, a low-order polynomial (such as a quadratic or cubic polynomial) may be used. If the signal has sharp edges or corners, a higher-order polynomial may be used.</p><p>The robustness of the algorithm comes from the use of a robust regression technique to fit the polynomial curve to the signal. Unlike ordinary least squares regression, which is sensitive to outliers, robust regression techniques are designed to downweight the influence of outliers on the fitting process, thus producing more accurate estimates of the underlying curve.</p><p>Examples of robust regression techniques that can be used for robust exact differentiation include the Huber loss function, the Tukey loss function, and the least trimmed squares method.</p><p>Overall, the robust exact differentiator is a powerful tool for accurately estimating the derivative of a signal in the presence of noise and outliers. However, it is computationally more expensive than some other differentiation techniques and requires careful selection of the polynomial order and regression technique to match the properties of the signal being analyzed.</p><h2 id="mathematical-description">Mathematical Description:</h2><p>Let <code>x</code> be the input signal, and <code>t</code> be the time vector corresponding to <code>x</code>. We wish to estimate the first derivative of <code>x</code> at each time point. We can do this by fitting a polynomial curve to <code>x</code> and then differentiating the polynomial function.</p><p>The general approach for a robust exact differentiator is as follows:</p><ol><li>Choose a polynomial order <code>n</code> based on the degree of smoothness of the signal. A low-order polynomial (e.g., quadratic or cubic) may be appropriate for a smooth signal, while a higher-order polynomial may be needed for a signal with sharp edges or corners.</li><li>Use a robust regression technique (e.g., Huber loss, Tukey loss, least trimmed squares) to fit the polynomial curve to the signal.</li><li>Differentiate the polynomial function to obtain the estimated derivative of <code>x</code>.</li></ol><p>Here is some example Python code that implements a robust exact differentiator using the Huber loss function:</p><p>```python import numpy as np from scipy.signal import savgol_filter from scipy.interpolate import CubicSpline</p><p>def robust_differentiator(x, t, n, alpha): # Apply Savitzky-Golay filter to smooth the signal x_filtered = savgol_filter(x, 2*n+1, n)</p><pre><code># Fit a polynomial to the filtered signal using the Huber loss function
poly_coeffs = np.polynomial.polynomial.polyfit(t, x_filtered, n)
poly_func = np.polynomial.polynomial.Polynomial(poly_coeffs)
residual = x_filtered - poly_func(t)
w = np.sqrt(np.maximum(1 - (residual/alpha)**2, 0))
robust_poly_coeffs = np.polynomial.polynomial.polyfit(t, x_filtered, n, w=w)

# Differentiate the polynomial to obtain the estimated derivative
poly_deriv = np.polynomial.polynomial.Polynomial(robust_poly_coeffs).deriv()
x_deriv = poly_deriv(t)

# Interpolate the derivative to the original time points
cs = CubicSpline(t, x_deriv)
x_deriv_interp = cs(t)

return x_deriv_interp
```
</code></pre><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main></body></html>
