<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Time Frequency Representations and Its Variants" /><meta name="author" content="Pavan Donthireddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="This article explains the concept of time frequency analysis, along with its variants and their implementation in Python." /><meta property="og:description" content="This article explains the concept of time frequency analysis, along with its variants and their implementation in Python." /><link rel="canonical" href="http://localhost:4000/2023/03/26/tf-representations" /><meta property="og:url" content="http://localhost:4000/2023/03/26/tf-representations" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-26T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Time Frequency Representations and Its Variants" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Pavan Donthireddy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pavan Donthireddy"},"dateModified":"2023-03-26T00:00:00+00:00","datePublished":"2023-03-26T00:00:00+00:00","description":"This article explains the concept of time frequency analysis, along with its variants and their implementation in Python.","headline":"Time Frequency Representations and Its Variants","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/03/26/tf-representations"},"url":"http://localhost:4000/2023/03/26/tf-representations"}</script><title> Time Frequency Representations and Its Variants - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/03/26/tf-representations" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="IntroductionTime-frequency analysis (TFA) is a technique that allows us to analyze signals in both time and frequency domains. Traditional Fourier analysis a..."><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="IntroductionTime-frequency analysis (TFA) is a technique that allows us to analyze signals in both time and frequency domains. Traditional Fourier analysis a..."/><meta property="og:title" content="Time Frequency Representations and Its Variants"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-03-26T00:00:00+00:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/03/26/tf-representations" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ jax: ["input/TeX","input/MathML","output/SVG", "output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "CHTML-preview.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"] }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }, messageStyle: "none", "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }, TeX: { equationNumbers: { autoNumber: "AMS" }, extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"], TagSide: "left", Macros: { field: ['\\mathbb{#1}', 1], C: ['\\field{C}'], E: ['\\field{E}'], F: ['\\field{F}'], N: ['\\field{N}'], P: ['\\field{P}'], Q: ['\\field{Q}'], R: ['\\field{R}'], Z: ['\\field{Z}'], ha : ['\\hat{#1}',1], Re: ['\\mathop{\\mathrm{Re}}'], Im: ['\\mathop{\\mathrm{Im}}'], Res: ['\\mathop{\\mathrm{Res}}'], } } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style><link rel="stylesheet" href="/_includes/prism.css"> <script src="/assets/js/prism.js"></script></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><link rel="stylesheet" href="/assets/js/prism.css"> <script src="/assets/js/prism.js"></script><section class="post"> <script src="/assets/js/prism.js"></script><h1 style="text-align: center;">Time Frequency Representations and Its Variants</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-03-26T00:00:00+00:00">March 26, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/time_frequency_methods">time_frequency_methods</a>, <a href="/tag/representation">representation</a>, <a href="/tag/STFT">STFT</a>, <a href="/tag/EMD">EMD</a></span></div><h2 id="introduction">Introduction</h2><p>Time-frequency analysis (TFA) is a technique that allows us to analyze signals in both time and frequency domains. Traditional Fourier analysis assumes that the signal is stationary over time, i.e., the frequency content of the signal is constant. However, in real-world applications, such as speech and music signal processing, the stationary assumption does not hold. TFA provides time-frequency representations of non-stationary signals, enabling us to study signal dynamics with changing frequency behavior.</p><h2 id="time-frequency-representations">Time Frequency Representations</h2><p>Time-frequency representations can be classified into four groups: Short-Time Fourier Transform (STFT), Continuous Wavelet Transform (CWT), Empirical Mode Decomposition (EMD) and Cohenâ€™s class.</p><h3 id="short-time-fourier-transform-stft">Short-Time Fourier Transform (STFT)</h3><p>STFT is a standard technique for time-frequency analysis that computes the Fourier transform of signal segments over time. The analysis window of a fixed-length is used to break down the signal into overlapping segments. An STFT of size $N$ applied to the signal $x(n)$ gives:</p>\[\begin{equation} X_{m,k} = \sum^{N-1}_{n=0}x(n+mH)w(n)e^{-j2\pi kn/N} \end{equation}\]<p>where $H$ is the hop-size between window frames, $w(n)$ is the analysis window, $m$ denotes the window frame number, and $k$ is the frequency index. The STFT is characterized by the window shape and length, as well as the hop size.</p><p>Python Implementation of STFT:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="n">scipy.signal</span> <span class="kn">import</span> <span class="n">get_window</span>
<span class="kn">from</span> <span class="n">scipy.fftpack</span> <span class="kn">import</span> <span class="n">fft</span>

<span class="k">def</span> <span class="nf">stft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">win</span><span class="p">,</span> <span class="n">hop</span><span class="p">):</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">nwin</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">win</span><span class="p">)</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">np</span><span class="p">.</span><span class="nf">ceil</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">log2</span><span class="p">(</span><span class="n">nwin</span><span class="p">)))</span>
    <span class="n">nframes</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">ceil</span><span class="p">((</span><span class="n">nx</span><span class="o">-</span><span class="n">nwin</span><span class="p">)</span><span class="o">/</span><span class="n">hop</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">pad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="n">nwin</span><span class="o">//</span><span class="mi">2</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s">'reflect'</span><span class="p">)</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">lib</span><span class="p">.</span><span class="n">stride_tricks</span><span class="p">.</span><span class="nf">as_strided</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nwin</span><span class="p">,</span> <span class="n">nframes</span><span class="p">),</span>
                                             <span class="n">strides</span><span class="o">=</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">itemsize</span><span class="p">,</span> <span class="n">hop</span><span class="o">*</span><span class="n">x</span><span class="p">.</span><span class="n">itemsize</span><span class="p">))</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="n">frames</span> <span class="o">*</span> <span class="n">win</span><span class="p">[:,</span> <span class="bp">None</span><span class="p">]</span>
    <span class="n">spectrum</span> <span class="o">=</span> <span class="nf">fft</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[:</span><span class="n">nfft</span><span class="o">//</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">spectrum</span>
</code></pre></div></div><h3 id="continuous-wavelet-transform-cwt">Continuous Wavelet Transform (CWT)</h3><p>CWT finds the time-frequency decomposition of the signal by using a time-varying window, or wavelet. The wavelet is scaled and shifted over time to obtain the distribution of the frequency and its variations with time. The CWT of a signal $x(t)$ with wavelet $\psi(t)$ is given by:</p>\[\begin{equation} W_x(a,b) = \int^{+\infty}_{-\infty}\psi^*(t)\frac{1}{\sqrt{|a|}}x(t)\exp{\bigg(\frac{i}{a}bt\bigg)}dt \end{equation}\]<p>where the wavelet $\psi(t)$ is scaled by a factor $a$ and shifted by $b$. CWT requires the selection of a suitable wavelet that is appropriate for the application.</p><p>Python Implementation of CWT:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pywt</span>

<span class="k">def</span> <span class="nf">cwt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">):</span>
    <span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">coef</span><span class="p">,</span> <span class="n">freqs</span> <span class="o">=</span> <span class="n">pywt</span><span class="p">.</span><span class="nf">cwt</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">wavelet</span><span class="p">,</span> <span class="n">sampling_period</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">1000</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coef</span>
</code></pre></div></div><h3 id="empirical-mode-decomposition-emd">Empirical Mode Decomposition (EMD)</h3><p>EMD is a data-driven, adaptive time-frequency decomposition method that decomposes a signal into Intrinsic Mode Functions (IMFs), resulting in a time-frequency representation. IMFs are the low-frequency components of the signal, and they represent the signalâ€™s local characteristics.</p><p>Python Implementation of EMD:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">emd</span>

<span class="k">def</span> <span class="nf">emd</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">emd_result</span> <span class="o">=</span> <span class="n">emd</span><span class="p">.</span><span class="n">sift</span><span class="p">.</span><span class="nf">sift</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">imfs</span> <span class="o">=</span> <span class="n">emd_result</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">imfs</span>
</code></pre></div></div><h3 id="cohens-class">Cohenâ€™s Class</h3><p>Cohenâ€™s class is a generalization of the STFT that allows the window function to vary over time. This generalization allows the use of different window functions that change over time. The Cohenâ€™s Class of a signal $x(t)$ with a window function $g(t,\tau)$ is given by:</p>\[\begin{equation} C_{g}(s, \tau) = \int_{-\infty}^{\infty}x(t)g^*(t, \tau)\exp(-j2\pi st)dt \end{equation}\]<p>where $g(t,\tau)$ is a time-varying window function dependent on a continuous parameter $\tau$.</p><p>Python Implementation of Cohenâ€™s Class:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="n">pyct</span> <span class="kn">import</span> <span class="n">saa</span>

<span class="k">def</span> <span class="nf">cohens_class</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">sst</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="n">saa</span><span class="p">.</span><span class="nf">s_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div><h1 id="time-frequency-representations-1">Time Frequency Representations</h1><p>In signal processing, it is often necessary to analyze signals in both time and frequency domains. However, traditional Fourier analysis is not sufficient as it only analyzes the frequency components and completely ignores the variations in time. This limitation led to the development of time frequency representations (TFRs) that analyze the frequency components of a signal at different points in time.</p><p>TFRs are important in many fields of signal processing, including speech processing, radar signal analysis, biomedical engineering, and image processing. There are many different types of TFRs, each with its own strengths and weaknesses.</p><h2 id="wigner-distribution-function">Wigner Distribution Function</h2><p>The Wigner distribution function (WDF) is a widely used TFR that was introduced in the 1930s by Eugene Wigner. It provides a joint time-frequency analysis and gives an estimate of the local energy density of a signal in time and frequency domains.</p><p>The WDF has several advantages. Firstly, it can accurately detect time-varying frequencies and phase information, making it useful for analyzing non-stationary signals. Secondly, it has good resolution properties and can distinguish between closely spaced frequency components. However, the WDF has some limitations. It has a high computational complexity and can produce negative values, making interpretation difficult.</p><h2 id="modified-distribution-functions">Modified Distribution Functions</h2><p>Modified distribution functions (MDFs) are a family of TFRs that include smoothed WDFs, spectrograms, and scalograms. Spectrograms are the most widely used MDFs and provide a frequency-time representation of a signal. They use a window function to obtain a smoothed version of the WDF and have a low computational complexity.</p><p>Scalograms are a type of MDF that uses wavelet transforms to analyze signals. They have good time-frequency resolution and can capture both high and low-frequency components of a signal. However, they have limited resolution in time and frequency if the wavelet basis function is not chosen properly.</p><h2 id="table-comparing-tfrs">Table comparing TFRs</h2><table><thead><tr><th>TFR</th><th>Pros</th><th>Cons</th></tr></thead><tbody><tr><td>Wigner</td><td>Accurate frequency and phase information. Good frequency resolution.</td><td>High computational complexity. Can produce negative values, making interpretation difficult.</td></tr><tr><td>Spectrogram</td><td>Low computational complexity. Good frequency resolution.</td><td>Limited time and frequency resolution.</td></tr><tr><td>Scalogram</td><td>Good time and frequency resolution. Can capture both high and low frequencies.</td><td>Limited resolution in time and frequency if the wavelet basis function is not chosen properly.</td></tr></tbody></table><p>In conclusion, TFRs are an essential tool in signal processing as they allow for a joint analysis of the time and frequency domains. The choice of TFR will depend on the specific requirements of the analysis, including the complexity of the signal and the desired resolution in time and frequency.</p><h2 id="conclusion">Conclusion</h2><p>Time-frequency analysis is a powerful technique for signal processing, especially when analyzing non-stationary signals. The article provided an introduction to TFA, discussing time-frequency representations and the need for them. Additionally, it explained the four main types of time-frequency representations and their working principles. Python implementations of Short-Time Fourier Transform (STFT), Continuous Wavelet Transform (CWT), Empirical Mode Decomposition (EMD), and Cohenâ€™s Class were also provided as examples.</p><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main></body></html>
