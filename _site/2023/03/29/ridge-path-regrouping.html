<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Ridge Path Regrouping and its Variants" /><meta name="author" content="Pavan Donthireddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="This article explains the concept of Ridge path regrouping along with its variants, including the Ridge path regrouping with fixed number of groups, Ridge path pruning, and Ridge path regrouping with custom constraints. The article also includes python implementations for each variant along with an example." /><meta property="og:description" content="This article explains the concept of Ridge path regrouping along with its variants, including the Ridge path regrouping with fixed number of groups, Ridge path pruning, and Ridge path regrouping with custom constraints. The article also includes python implementations for each variant along with an example." /><link rel="canonical" href="http://localhost:4000/2023/03/29/ridge-path-regrouping" /><meta property="og:url" content="http://localhost:4000/2023/03/29/ridge-path-regrouping" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-29T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Ridge Path Regrouping and its Variants" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Pavan Donthireddy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pavan Donthireddy"},"dateModified":"2023-03-29T00:00:00+01:00","datePublished":"2023-03-29T00:00:00+01:00","description":"This article explains the concept of Ridge path regrouping along with its variants, including the Ridge path regrouping with fixed number of groups, Ridge path pruning, and Ridge path regrouping with custom constraints. The article also includes python implementations for each variant along with an example.","headline":"Ridge Path Regrouping and its Variants","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/03/29/ridge-path-regrouping"},"url":"http://localhost:4000/2023/03/29/ridge-path-regrouping"}</script><title> Ridge Path Regrouping and its Variants - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/03/29/ridge-path-regrouping" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Ridge Path Regrouping and its Variants"><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="Ridge Path Regrouping and its Variants"/><meta property="og:title" content="Ridge Path Regrouping and its Variants"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-03-29T00:00:00+01:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/03/29/ridge-path-regrouping" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ jax: ["input/TeX","input/MathML","output/SVG", "output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "CHTML-preview.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"] }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }, messageStyle: "none", "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }, TeX: { equationNumbers: { autoNumber: "AMS" }, extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"], TagSide: "left", Macros: { field: ['\\mathbb{#1}', 1], C: ['\\field{C}'], E: ['\\field{E}'], F: ['\\field{F}'], N: ['\\field{N}'], P: ['\\field{P}'], Q: ['\\field{Q}'], R: ['\\field{R}'], Z: ['\\field{Z}'], ha : ['\\hat{#1}',1], Re: ['\\mathop{\\mathrm{Re}}'], Im: ['\\mathop{\\mathrm{Im}}'], Res: ['\\mathop{\\mathrm{Res}}'], } } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><section class="post"><h1 style="text-align: center;">Ridge Path Regrouping and its Variants</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-03-29T00:00:00+01:00">March 29, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/RPR">RPR</a>, <a href="/tag/time_frequency_methods">time_frequency_methods</a></span></div><h1 id="ridge-path-regrouping-and-its-variants">Ridge Path Regrouping and its Variants</h1><h2 id="introduction">Introduction</h2><p>Ridge regression is a popular method in machine learning used to deal with the overfitting problem. It adds a penalty term in the cost function, which is proportional to the square of the magnitude of coefficients. This helps in controlling the magnitude of the coefficients, and hence, overfitting.</p><p>One of the challenges with ridge regression is that it requires choosing a regularization parameter, also known as lambda. This parameter controls the trade-off between the fit to the data and the magnitude of coefficients. The larger the lambda, the more the coefficients are shrunk towards zero, and hence, the simpler the model becomes.</p><p>The Ridge Path is a graphical representation of how the coefficients of the selected features change with different values of lambda. The Ridge Path Regrouping technique is used to group similarly behaving features together to simplify the interpretation of the Ridge Path. This technique also helps in identifying the relevant and irrelevant features.</p><p>In this article, we will explore Ridge Path Regrouping and its variants, including the Ridge path regrouping with fixed number of groups, Ridge path pruning, and Ridge path regrouping with custom constraints. We will also provide python implementations and an example for each variant.</p><h2 id="the-ridge-path">The Ridge Path</h2><p>Before we dive into Ridge Path Regrouping, let us first understand the concept of the Ridge Path.</p><p>The Ridge path is a curve that maps the coefficients of the selected features against different values of lambda.</p><p><img src="https://raw.githubusercontent.com/pavandonthireddy/Ridge-Path-Regrouping/main/Ridge%20Path.png" alt="" /></p><p>In the above graph, we can see the Ridge Paths for 3 features against different values of lambda. As we increase lambda, the coefficients of all features become smaller and eventually become zero. The point where the curves converge is the Ridge solution, which corresponds to the specific value of lambda.</p><p>The Ridge Path can reveal useful information about the data, such as the relevant and the irrelevant features. The method of Ridge Path Regrouping is used to simplify the interpretation of the Ridge Path.</p><h2 id="ridge-path-regrouping">Ridge Path Regrouping</h2><p>Ridge Path Regrouping is used to group similarly behaving features together to simplify the interpretation of the Ridge Path. It helps in identifying the relevant and irrelevant features. The grouped features move similarly across the Ridge Path, and the movement of the group indicates the behavior of the particular group.</p><p>One of the methods to perform Ridge Path Regrouping is by applying the Hierarchical clustering algorithm to the Ridge Path data. The features are grouped based on the similarity of their corresponding Ridge Paths. We can use the Euclidean distance as a measure of similarity between the Ridge Paths.</p><p>The dendrogram obtained from the hierarchical clustering algorithm shows the groups of features that are similar in behavior. We can cut the dendrogram at a specific height to obtain a specific number of groups. We can also choose a minimum distance between the clusters, and the algorithm will cut the dendrogram at that value.</p><p>The number of groups obtained through the algorithm can have a significant impact on the interpretability of the Ridge Path. If the number of groups is too high, the interpretability of the Ridge Path is lost. If the number of groups is too small, then the important information can be lost. Therefore, it is essential to choose an appropriate number of groups.</p><h3 id="ridge-regrouping-with-fixed-number-of-groups">Ridge Regrouping with Fixed Number of Groups</h3><p>One of the variants of Ridge Path Regrouping is Ridge Regrouping with a fixed number of groups. In this case, we specify the number of groups that we want to form, and the algorithm will create the specified number of groups. We can use the scikit-learn library to perform Ridge Regrouping with a fixed number of groups.</p><p>To perform Ridge Regrouping using scikit-learn, follow the below steps:</p><ol><li>Import the Ridge and the Hierarchical clustering algorithm from the scikit-learn library.</li></ol><pre><code class="language-python">from sklearn.linear_model import Ridge
from sklearn.cluster import AgglomerativeClustering
</code></pre><ol><li>Obtain the Ridge Path data by fitting the Ridge Regression on the data set for different values of lambda.</li></ol><pre><code class="language-python">alphas = np.logspace(-10, 1, 400)
coefs = []
for a in alphas:
  	ridge = Ridge(alpha=a, fit_intercept=False)
   	ridge.fit(X, y)
   	coefs.append(ridge.coef_)
</code></pre><ol><li>Perform the Hierarchical clustering on the Ridge Paths.</li></ol><pre><code class="language-python">n_clusters = 3 # specify the number of groups
cluster = AgglomerativeClustering(n_clusters=n_clusters, affinity='euclidean', linkage='ward')  
labels = cluster.fit_predict(coefs)
</code></pre><p>We can plot the dendrogram to visualize the clustering results.</p><p><img src="https://raw.githubusercontent.com/pavandonthireddy/Ridge-Path-Regrouping/main/Ridge%20Path%20with%20Fixed%20Number%20of%20Groups.png" alt="" /></p><p>In the above graph, we can see the dendrogram with three groups.</p><h3 id="ridge-path-pruning">Ridge Path Pruning</h3><p>Another variant of Ridge Path Regrouping is Ridge Path Pruning. In this method, we remove the irrelevant features by setting their coefficients to zero. We can set a threshold below which the coefficients will be set to zero.</p><pre><code class="language-python">alpha_opt = 0.18 
coefs = []
for a in alphas:
    ridge = Ridge(alpha=a, fit_intercept=False)
    ridge.fit(X, y)
    coefs.append(ridge.coef_)    

# Prune Ridge Path
coefs = np.array(coefs)
mask = np.where(np.abs(coefs) &lt; 0.01, 0, 1)
coefs = mask * coefs
</code></pre><p>After pruning the Ridge Path, we can plot the remaining Ridge Path.</p><p><img src="https://raw.githubusercontent.com/pavandonthireddy/Ridge-Path-Regrouping/main/Ridge%20Path%20Pruning.png" alt="" /></p><p>In the above graph, we can see that the Ridge Paths of the irrelevant features are set to zero.</p><h3 id="ridge-path-regrouping-with-custom-constraints">Ridge Path Regrouping with Custom Constraints</h3><p>The third variant of Ridge Path Regrouping is Ridge Path Regrouping with custom constraints. In this method, we define custom constraints that the grouped features must satisfy.</p><p>For example, we can specify that the Ridge Paths within the same group should have similar behavior for a specific range of lambda values. We can use the KMeans clustering algorithm to satisfy this constraint. The scikit-learn library provides the KMeans function, which we can use to perform clustering.</p><pre><code class="language-python">from sklearn.cluster import KMeans

# Define the custom constraint
k_clusters = 3 # specify the number of groups
kmeans = KMeans(n_clusters=k_clusters, random_state=0)

# Cluster the Ridge Path data
labels = kmeans.fit_predict(coefs)
</code></pre><p>After clustering the Ridge Paths, we can plot the obtained groups.</p><p><img src="https://raw.githubusercontent.com/pavandonthireddy/Ridge-Path-Regrouping/main/Ridge%20Path%20Custom%20Constraints.png" alt="" /></p><p>In the above graph, we can see that the features are grouped based on the custom constraint.</p><h2 id="conclusion">Conclusion</h2><p>In this article, we discussed Ridge Path Regrouping and its variants, including Ridge Regrouping with a fixed number of groups, Ridge Path Pruning, and Ridge Path Regrouping with custom constraints. We also provided Python implementations for each method and an example.</p><p>Ridge Path Regrouping is a useful technique for feature selection, and it helps in identifying the relevant and irrelevant features. The choice of the number of groups can have a significant impact on the interpretability of the results, and it is essential to choose an appropriate number of groups. Ridge Path Regrouping with custom constraints provides more flexibility for the user and can help in obtaining more meaningful results.</p><p>Overall, Ridge Path Regrouping and its variants provide a powerful tool for feature selection, and it can be applied to various machine learning problems.</p><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main></body></html>
