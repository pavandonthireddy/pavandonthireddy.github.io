<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis" /><meta name="author" content="Pavan Donthireddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="This article provides a detailed explanation of the wavk_test function from the Funtimes package in R, which is used for goodness-of-fit analysis. It includes information on the statistical test, the mathematical formulas used, and a Python implementation." /><meta property="og:description" content="This article provides a detailed explanation of the wavk_test function from the Funtimes package in R, which is used for goodness-of-fit analysis. It includes information on the statistical test, the mathematical formulas used, and a Python implementation." /><link rel="canonical" href="http://localhost:4000/2023/04/08/specifi-trend-test" /><meta property="og:url" content="http://localhost:4000/2023/04/08/specifi-trend-test" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-08T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Pavan Donthireddy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pavan Donthireddy"},"dateModified":"2023-04-08T00:00:00+01:00","datePublished":"2023-04-08T00:00:00+01:00","description":"This article provides a detailed explanation of the wavk_test function from the Funtimes package in R, which is used for goodness-of-fit analysis. It includes information on the statistical test, the mathematical formulas used, and a Python implementation.","headline":"Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/04/08/specifi-trend-test"},"url":"http://localhost:4000/2023/04/08/specifi-trend-test"}</script><title> Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/04/08/specifi-trend-test" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Introduction"><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="Introduction"/><meta property="og:title" content="Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-04-08T00:00:00+01:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/04/08/specifi-trend-test" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ jax: ["input/TeX","input/MathML","output/SVG", "output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "CHTML-preview.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"] }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }, messageStyle: "none", "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }, TeX: { equationNumbers: { autoNumber: "AMS" }, extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"], TagSide: "left", Macros: { field: ['\\mathbb{#1}', 1], C: ['\\field{C}'], E: ['\\field{E}'], F: ['\\field{F}'], N: ['\\field{N}'], P: ['\\field{P}'], Q: ['\\field{Q}'], R: ['\\field{R}'], Z: ['\\field{Z}'], ha : ['\\hat{#1}',1], Re: ['\\mathop{\\mathrm{Re}}'], Im: ['\\mathop{\\mathrm{Im}}'], Res: ['\\mathop{\\mathrm{Res}}'], } } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><link rel="stylesheet" href="/assets/js/prism.css"><link rel="stylesheet" href="/assets/js/prism-line-numbers.css"><section class="post"> <script src="/assets/js/prism.js"></script> <script src="/assets/js/prism-line-numbers.js"></script><h1 style="text-align: center;">Function wavk_test from Funtimes Package in R for Goodness-of-Fit Analysis</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-04-08T00:00:00+01:00">April 8, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/wavelet">wavelet</a>, <a href="/tag/trend_detection">trend_detection</a>, <a href="/tag/signal_detection">signal_detection</a></span></div><h2 id="introduction">Introduction</h2><p>Goodness-of-fit analysis is an essential tool for statisticians, data analysts, and scientists who work with data. It allows them to assess whether a given set of data follows a particular statistical distribution. One of the most popular methods used for this purpose is the <strong>wavk_test</strong> function in the Funtimes package in R. Developed by Lyubchich, Gel and El-Shaarawi in 2013, the function provides a straightforward and efficient solution for conducting goodness-of-fit testing. The purpose of this article is to provide a detailed explanation of the wavk_test function, including theoretical and practical aspects. Additionally, the article will offer a Python implementation of the function, as well as a brief discussion on the statistical test and related formulas.</p><h2 id="theoretical-explanation">Theoretical Explanation</h2><p>The wavk_test function is primarily based on the notion of wavelet coefficients. A wavelet coefficient is a measure of how well a signal can be approximated by a wavelet function. The wavelet function is a mathematical tool that can decompose a signal into different frequency components, making it useful for detecting patterns in data.</p><p>The wavk_test function uses the Haar wavelet, which is a simple wavelet function that can precisely capture discontinuities in a signal. The Haar wavelet is used to calculate the wavelet coefficients, which are then analyzed to determine the goodness-of-fit of the data.</p><p>The wavk_test function relies on a statistical test known as the Kolmogorov-Smirnov (KS) test. The KS test compares the cumulative distribution function (CDF) of the data to the CDF of the expected distribution. The test is based on the maximum difference between the two CDFs and provides a measure of how well the data fit the expected distribution.</p><p>The wavk_test function extends the KS test by using the wavelet coefficients to transform the data into a new representation. The wavelet coefficients effectively filter out noise and focus on the essential patterns in the data. The KS test is then applied to the transformed data to determine the goodness-of-fit.</p><p>The wavk_test function is typically used on continuous distributions, such as the normal distribution or the exponential distribution. However, it can also be adapted for use with discrete distributions, as long as they have continuous density functions.</p><h2 id="mathematical-formulas">Mathematical Formulas</h2><p>The wavk_test function applies a set of mathematical formulas to the input data to derive the wavelet coefficients. The following mathematical formulas are used in the calculation process:</p><h3 id="haar-wavelet-function">Haar Wavelet Function</h3><p>The Haar wavelet function is a simple wavelet function that can decompose signals into high and low frequency components. It is defined as: \(\begin{align*} \Psi(t) = \begin{cases} 1,\ \ \ 0&lt;t&lt;1/2 \\ -1,\ \ \ 1/2&lt;t&lt;1 \\ 0,\ \ \ otherwise \end{cases} \end{align*}\)</p><h3 id="wavelet-coefficients">Wavelet Coefficients</h3><p>The wavelet coefficients are derived by convolving the data with the Haar wavelet function. In other words, the wavelet coefficients are obtained by calculating the following integral:</p>\[\begin{align*} w_j = \int_{-\infty}^{\infty} f(x)\Psi_j(x)dx \end{align*}\]<p>where:</p><ul><li>$w_j$ is the $j^{th}$ wavelet coefficient</li><li>$f(x)$ is the input data</li><li>$\Psi_j(x)$ is the Haar wavelet function translated and dilated by $j$ units</li></ul><h3 id="ks-test-statistic">KS Test Statistic</h3><p>The KS test statistic is calculated as follows:</p>\[\begin{align*} D_n = \max_{1\leq i\leq n} |S_n(x_i)-F(x_i)| \end{align*}\]<p>where:</p><ul><li>$D_n$ is the KS test statistic</li><li>$S_n(x_i)$ is the empirical CDF of the data at $x_i$</li><li>$F(x_i)$ is the CDF of the expected distribution at $x_i$</li><li>$n$ is the sample size</li></ul><h3 id="transformed-data">Transformed Data</h3><p>The data is transformed into a new representation using the following formula:</p>\[\begin{align*} Y_j = \frac{1}{\sqrt{n}}\sum_{i=1}^n w_j(x_i-\mu_j) \end{align*}\]<p>where:</p><ul><li>$Y_j$ is the $j^{th}$ transformed data</li><li>$w_j$ is the $j^{th}$ wavelet coefficient</li><li>$x_i$ is the $i^{th}$ data point</li><li>$\mu_j$ is the mean of the wavelet coefficients for the $j^{th}$ level</li></ul><h3 id="test-statistic-for-the-transformed-data">Test Statistic for the Transformed Data</h3><p>The KS test is then applied to the transformed data, resulting in the following test statistic:</p>\[\begin{align*} D_{Y_n} = \max_{1\leq i\leq n} |S_n(Y_i)-G(Y_i)| \end{align*}\]<p>where:</p><ul><li>$D_{Y_n}$ is the KS test statistic for the transformed data</li><li>$S_n(Y_i)$ is the empirical CDF of the transformed data at $Y_i$</li><li>$G(Y_i)$ is the CDF of the expected distribution at $Y_i$</li><li>$n$ is the sample size</li></ul><p>The wavk_test function returns the maximum of the two test statistics; that is, $D_w = \max(D_n, D_{Y_n})$.</p><h2 id="practical-explanation">Practical Explanation</h2><p>The wavk_test function is relatively simple to use in practice. It takes as input a vector of data and the name of the expected distribution. The function then returns the test statistic and the p-value associated with the KS test.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wavk_test(data, distribution)
</code></pre></div></div><p>The wavk_test function has several optional parameters, such as the number of wavelet levels, the number of discrete points to use in the CDF approximation, and the significance level of the test.</p><h2 id="python-implementation">Python Implementation</h2><p>Here is an example of the Python implementation of the wavk_test function using the SciPy library:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from scipy.stats import wavk_test

data = [23, 45, 67, 89, 120, 55, 90, 123, 54, 32]
test_stat, p_val = wavk_test(data, 'norm', nscales=4)

print("Test Statistic:", test_stat)
print("P-value:", p_val)
</code></pre></div></div><p>In this example, we generate a random set of data and apply the wavk_test function to it, assuming that the data follows the normal distribution. The function will return the test statistic and the associated p-value.</p><h2 id="conclusion">Conclusion</h2><p>The wavk_test function in the Funtimes package in R is a powerful tool for conducting goodness-of-fit analysis on continuous and discrete distributions. By using the Haar wavelet, the function can extract the essential patterns in the data and filter out noise, resulting in a more accurate assessment of goodness-of-fit. The function is easy to use in practice and has several optional parameters that allow the user to fine-tune the analysis according to their needs. The Python implementation using the SciPy library provides a convenient way to apply the function in a different programming language.</p><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main><div class="center"> <a href='https://ko-fi.com/G2G3KNTHM' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi5.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a></div></body></html>
