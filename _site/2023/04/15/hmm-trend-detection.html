<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Using HMM to Find Out the Trend of a Signal or Time Series in Real Time" /><meta name="author" content="Pavan Donthireddy" /><meta property="og:locale" content="en_US" /><meta name="description" content="This article discusses the use of Hidden Markov Models (HMMs) to identify the trend of a signal or time series in real time. It provides a detailed explanation of the theory behind HMMs and their implementation using Python code." /><meta property="og:description" content="This article discusses the use of Hidden Markov Models (HMMs) to identify the trend of a signal or time series in real time. It provides a detailed explanation of the theory behind HMMs and their implementation using Python code." /><link rel="canonical" href="http://localhost:4000/2023/04/15/hmm-trend-detection" /><meta property="og:url" content="http://localhost:4000/2023/04/15/hmm-trend-detection" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-15T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Using HMM to Find Out the Trend of a Signal or Time Series in Real Time" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Pavan Donthireddy" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pavan Donthireddy"},"dateModified":"2023-04-15T00:00:00+01:00","datePublished":"2023-04-15T00:00:00+01:00","description":"This article discusses the use of Hidden Markov Models (HMMs) to identify the trend of a signal or time series in real time. It provides a detailed explanation of the theory behind HMMs and their implementation using Python code.","headline":"Using HMM to Find Out the Trend of a Signal or Time Series in Real Time","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/04/15/hmm-trend-detection"},"url":"http://localhost:4000/2023/04/15/hmm-trend-detection"}</script><title> Using HMM to Find Out the Trend of a Signal or Time Series in Real Time - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/04/15/hmm-trend-detection" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Introduction"><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="Introduction"/><meta property="og:title" content="Using HMM to Find Out the Trend of a Signal or Time Series in Real Time"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-04-15T00:00:00+01:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/04/15/hmm-trend-detection" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ jax: ["input/TeX","input/MathML","output/SVG", "output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "CHTML-preview.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"] }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }, messageStyle: "none", "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }, TeX: { equationNumbers: { autoNumber: "AMS" }, extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"], TagSide: "left", Macros: { field: ['\\mathbb{#1}', 1], C: ['\\field{C}'], E: ['\\field{E}'], F: ['\\field{F}'], N: ['\\field{N}'], P: ['\\field{P}'], Q: ['\\field{Q}'], R: ['\\field{R}'], Z: ['\\field{Z}'], ha : ['\\hat{#1}',1], Re: ['\\mathop{\\mathrm{Re}}'], Im: ['\\mathop{\\mathrm{Im}}'], Res: ['\\mathop{\\mathrm{Res}}'], } } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><link rel="stylesheet" href="/assets/js/prism.css"><link rel="stylesheet" href="/assets/js/prism-line-numbers.css"><section class="post"> <script src="/assets/js/prism.js"></script> <script src="/assets/js/prism-line-numbers.js"></script><h1 style="text-align: center;">Using HMM to Find Out the Trend of a Signal or Time Series in Real Time</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-04-15T00:00:00+01:00">April 15, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/trend_detection">trend_detection</a>, <a href="/tag/HMM">HMM</a></span></div><h1 id="introduction">Introduction</h1><p>Hidden Markov Models (HMMs) are widely used in time series analysis and other machine learning applications. HMMs are a type of statistical model that uses observed data to infer the hidden state of a system. They have been successfully applied in speech recognition, text recognition, bioinformatics, and many other domains.</p><p>One important application of HMMs is in real-time trend analysis of time series data. In this article, we will discuss how HMMs can be used to identify the trend of a signal or time series in real time. We will start with a brief overview of the theory behind HMMs and then move on to the implementation using Python code.</p><h1 id="theory">Theory</h1><h2 id="hidden-markov-models">Hidden Markov Models</h2><p>A Hidden Markov Model is a statistical model that can be used to model time series data. It consists of a set of latent variables, known as hidden states, that are not directly observable. The hidden states generate the observed data, which are the observations.</p><p>The basic idea is that the hidden states encode information about the underlying pattern in the data, while the observations are simply noisy measurements of these underlying patterns. The goal is to infer the hidden states from the observations.</p><p>The HMM is characterized by three components:</p><ul><li><strong>State transition probability matrix</strong>: This matrix defines the probability of moving from one state to another in the underlying Markov chain that generates the hidden states.</li><li><strong>Observation probability distribution</strong>: This distribution defines the probability of observing a given observation given the current hidden state.</li><li><strong>Initial state probability distribution</strong>: This distribution defines the probability of starting in each of the possible hidden states.</li></ul><p>The HMM can be thought of as a generative model of the observed data. That is, given the hidden states, we can use the observation probability distribution to generate a sequence of observations. Conversely, given a sequence of observations, we can use the Viterbi algorithm or the forward-backward algorithm to infer the most likely sequence of hidden states that generated the observations.</p><h2 id="trend-analysis-with-hmms">Trend Analysis with HMMs</h2><p>In the context of time series analysis, we can use HMMs to identify the trend of a signal in real time. The idea is to model the trend as a sequence of hidden states, with each state corresponding to a different trend regime. For example, in a financial time series, we might have a bull market regime, a bear market regime, and a sideways market regime.</p><p>We can then use the observation probability distribution to model the observed data as a noisy version of the underlying trend. This allows us to identify the current trend regime in real time, as well as predict future trends.</p><h1 id="implementation">Implementation</h1><p>We will now discuss the implementation of the HMM for trend analysis using Python code. We will use the <code class="language-plaintext highlighter-rouge">hmmlearn</code> library, which is a widely used library for HMMs.</p><h2 id="data-preparation">Data Preparation</h2><p>We will use the <code class="language-plaintext highlighter-rouge">sunspots</code> dataset from the <code class="language-plaintext highlighter-rouge">statsmodels</code> library, which contains monthly sunspot numbers from 1749 to 2017. We will use the number of sunspots as our observed data.</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">statsmodels.datasets</span> <span class="kn">import</span> <span class="n">sunspots</span>

<span class="c1"># Load the dataset
</span><span class="n">data</span> <span class="o">=</span> <span class="n">sunspots</span><span class="p">.</span><span class="nf">load_pandas</span><span class="p">().</span><span class="n">data</span><span class="p">[</span><span class="s">'SUNACTIVITY'</span><span class="p">].</span><span class="n">values</span>
</code></pre></div></div><h2 id="model-definition">Model Definition</h2><p>We will define our HMM model as follows:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">hmmlearn</span> <span class="kn">import</span> <span class="n">hmm</span>

<span class="c1"># Define the model
</span><span class="n">model</span> <span class="o">=</span> <span class="n">hmm</span><span class="p">.</span><span class="nc">GaussianHMM</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="s">"full"</span><span class="p">,</span> <span class="n">n_iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></div><p>Here, we are using a Gaussian HMM with three hidden states, a full covariance matrix, and 100 iterations of the Baum-Welch algorithm for parameter estimation.</p><h2 id="training">Training</h2><p>We can train the model on the data using the <code class="language-plaintext highlighter-rouge">fit</code> function:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Train the model
</span><span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></div><h2 id="predicting-hidden-states-and-trends">Predicting Hidden States and Trends</h2><p>We can use the <code class="language-plaintext highlighter-rouge">predict</code> function to predict the most likely sequence of hidden states:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Predict the hidden states
</span><span class="n">hidden_states</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></div><p>We can then plot the observed data and the predicted hidden states:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Plot the data with the hidden states
</span><span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">([</span><span class="s">'Data'</span><span class="p">,</span> <span class="s">'Hidden States'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div><p>We can see that the HMM has successfully identified the major trend regimes in the data.</p><h2 id="generating-future-observations">Generating Future Observations</h2><p>We can use the <code class="language-plaintext highlighter-rouge">sample</code> function to generate future observations based on the learned model:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Generate future observations
</span><span class="n">future_data</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="mi">24</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></div><p>Here, we are generating 24 new observations based on the learned model.</p><h1 id="conclusion">Conclusion</h1><p>In this article, we discussed how Hidden Markov Models can be used to identify the trend of a signal or time series in real time. We provided a detailed explanation of the theory behind HMMs and their implementation using Python code. We showed how HMMs can be trained on time series data to identify trend regimes, and how future observations can be generated based on the learned model.</p><p>HMMs are a powerful tool for time series analysis, and their application to trend analysis can have many practical uses. By identifying trends in real time, we can make more informed decisions about financial investments, weather patterns, and more.</p><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main><div class="center"> <a href='https://ko-fi.com/G2G3KNTHM' target='_blank'><img height='36' style='border:0px;height:36px;' src='https://storage.ko-fi.com/cdn/kofi5.png?v=3' border='0' alt='Buy Me a Coffee at ko-fi.com' /></a></div></body></html>
