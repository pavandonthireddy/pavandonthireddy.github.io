<!DOCTYPE html><html lang="en" ><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Adaptive fourier Decomposition" /><meta property="og:locale" content="en_US" /><meta name="description" content="Adaptive fourier Decomposition" /><meta property="og:description" content="Adaptive fourier Decomposition" /><link rel="canonical" href="http://localhost:4000/2023/02/23/afd" /><meta property="og:url" content="http://localhost:4000/2023/02/23/afd" /><meta property="og:site_name" content="Pavan Donthireddy" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-23T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Adaptive fourier Decomposition" /><meta name="twitter:site" content="@" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-23T00:00:00+00:00","datePublished":"2023-02-23T00:00:00+00:00","description":"Adaptive fourier Decomposition","headline":"Adaptive fourier Decomposition","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2023/02/23/afd"},"url":"http://localhost:4000/2023/02/23/afd"}</script><title> Adaptive fourier Decomposition - Pavan Donthireddy</title><meta charset="UTF-8"><link rel="canonical" href="http://localhost:4000/2023/02/23/afd" /><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Adaptive Fourier Decomposition (AFD) Algorithm"><meta property="og:site_name" content="Pavan Donthireddy"><meta property="og:description" content="Adaptive Fourier Decomposition (AFD) Algorithm"/><meta property="og:title" content="Adaptive fourier Decomposition"><meta property="og:type" content="article"><meta property="article:published_time" content="2023-02-23T00:00:00+00:00"><meta property="article:author" content="http://localhost:4000/"><meta property="og:url" content="http://localhost:4000/2023/02/23/afd" /><link rel="shortcut icon" href="/favicon.png"><link rel="alternate" type="application/atom+xml" title="Pavan Donthireddy" href="/atom.xml"><link rel="alternate" type="application/json" title="Pavan Donthireddy" href="http://localhost:4000/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ jax: ["input/TeX","input/MathML","output/SVG", "output/CommonHTML"], extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "CHTML-preview.js"], TeX: { extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"] }, tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true, processEnvironments: true, skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'] }, messageStyle: "none", "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }, TeX: { equationNumbers: { autoNumber: "AMS" }, extensions: ["AMSmath.js", "AMSsymbols.js","AMScd.js"], TagSide: "left", Macros: { field: ['\\mathbb{#1}', 1], C: ['\\field{C}'], E: ['\\field{E}'], F: ['\\field{F}'], N: ['\\field{N}'], P: ['\\field{P}'], Q: ['\\field{Q}'], R: ['\\field{R}'], Z: ['\\field{Z}'], ha : ['\\hat{#1}',1], Re: ['\\mathop{\\mathrm{Re}}'], Im: ['\\mathop{\\mathrm{Im}}'], Res: ['\\mathop{\\mathrm{Res}}'], } } }); </script> <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><style> *,:after,:before{box-sizing:border-box;background-color:inherit;color:inherit;margin:0;padding:0}body{font-family:system-ui,sans-serif;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;line-height:1.5;font-size:1rem;color:#16171a}nav ul{border-right:1px solid #edf2f7}a{color:#000;text-decoration-skip-ink:auto;text-decoration:underline}pre{margin:.5rem 0;padding:.5rem}.post p{margin:.5rem 0}.post h1,.post h2,.post h3,.post h4{margin:1rem 0}.post h2:first-child,.project h2:first-child,.photo h2:first-child{margin-top:0}.meta{margin:2rem 0}code,pre{background:#ecedee}code{padding:.1rem}pre code{border:none}pre{padding:1rem;overflow-x:auto}img{max-width:100%}hr{background:#000;height:1px;border:0}header{flex-basis:10rem;flex-grow:1;position:relative}header a{text-decoration:none}header li{margin-bottom:.2rem;text-align:right;margin-right:2rem}header a.active{font-weight:bold}header,section{padding:1rem}blockquote{font-style:italic;border-left:5px solid #ececec;padding-left:1rem}h1,h2,h3,h4,h5{line-height:1;margin:1rem 0;font-weight:600}section h1:first-child{margin-top:0}strong,b{font-weight:bold}.photos ul{list-style:none}.photos li{margin-bottom:1.5rem}.photo picture,.project picture{margin-bottom:.5rem}.posts ul,header ul{list-style:none}.posts li{align-items:center;display:flex;justify-content:space-between;margin-bottom:.5rem}.posts li a,.posts li div,.projects li a{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.posts li time,.projects li time{padding-left:1rem;white-space:nowrap;font-variant-numeric:tabular-nums}main{display:flex;flex-wrap:wrap;max-width:60rem;margin:2rem auto;padding:1rem}@media screen and (max-width: 45rem){header li{display:inline;margin-right:1rem}.logo{padding-bottom:1rem}header ul{border-bottom:1px solid #edf2f7;padding-bottom:2rem}nav ul{border-right:0px}.photos ul{margin-top:.5rem}}section{flex-basis:0;flex-grow:999;min-width:70%;display:flex;flex-direction:column}figcaption{font-size:smaller}.post-archive{font-size:15px;line-height:2;padding-bottom:.8em}.post-archive .date{padding-right:.7em}.pagination{width:100%;padding:0 20px;text-align:center}.pagination ul{list-style:none}.pagination ul li{display:inline;margin:0 5px}.pagination ul li a{color:#000;text-decoration:none}.pagination ul li a:hover{color:gray;text-decoration:underline}.pagination ul li.current-page a{background:#ddd;color:#fff}.post-link{position:relative;display:inline-block}.post-excerpt{display:none;position:absolute;z-index:1;top:100%;left:0;width:100%;padding:10px;background-color:#fff;box-shadow:0 2px 5px rgba(0,0,0,.1)}.post-link:hover .post-excerpt{display:block}.img-padding{width:200px;height:200px;padding:20px 20px 20px 20px}</style></head><body><main role="main"><header role="banner"> <!--<h1 class="logo">Pavan Donthireddy</h1>--><nav role="navigation"><ul><li><a href="/" >Notes</a></li><li><a href="/tags" >Tags</a></li><li><a href="/search" >Search</a></li><li><a href="/about" >About</a></li></ul></nav></header><link rel="stylesheet" href="/assets/js/prism.css"><link rel="stylesheet" href="/assets/js/prism-line-numbers.css"><section class="post"> <script src="/assets/js/prism.js"></script> <script src="/assets/js/prism-line-numbers.js"></script><h1 style="text-align: center;">Adaptive fourier Decomposition</h1><div style="text-align: center;"><span class="meta"><time datetime="2023-02-23T00:00:00+00:00">February 23, 2023</time> </span></div><div style="text-align: center;"><span class="meta"> <a href="/tag/AFD">AFD</a>, <a href="/tag/trend_estimation">trend_estimation</a>, <a href="/tag/signal_extraction">signal_extraction</a></span></div><h2 id="adaptive-fourier-decomposition-afd-algorithm">Adaptive Fourier Decomposition (AFD) Algorithm</h2><p>The Adaptive Fourier Decomposition (AFD) algorithm is a data-driven approach for analyzing nonlinear and non-stationary signals. It decomposes a signal into a sum of sinusoidal functions with time-varying frequencies, amplitudes, and phases, allowing for a more accurate representation of the underlying dynamics.</p><p>The AFD algorithm iteratively extracts sinusoidal components from the signal by fitting them to the residual signal, which is the original signal minus the sum of previously extracted components. The frequency, amplitude, and phase of each sinusoidal component are adjusted adaptively based on the residual signal, leading to a more accurate decomposition of the signal.</p><p>Mathematically, let x(t) be the signal to be decomposed. The AFD algorithm decomposes x(t) into a sum of K sinusoidal functions as follows:</p>\[x(t) = \sum_{k=1}^K A_k(t) \sin(2\pi f_k(t)t + \phi_k(t)) + r(t)\]<p>where $A_k(t), f_k(t),$ and $\phi_k(t)$ are the amplitude, frequency, and phase of the k-th component at time t, respectively, and r(t) is the residual signal.</p><p>The AFD algorithm has many applications in signal processing, including feature extraction, noise reduction, and signal denoising.</p><h2 id="python-implementation">Python Implementation</h2><p>Here is a Python implementation of the AFD algorithm using the NumPy library:</p><div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">afd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_components</span><span class="p">):</span>
    <span class="c1"># Initialize residual signal and extracted components
</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_components</span><span class="p">):</span>
        <span class="c1"># Compute the Fourier transform of the residual signal
</span>        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="nf">fft</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        
        <span class="c1"># Find the frequency with the maximum amplitude
</span>        <span class="n">f_max</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argmax</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
        
        <span class="c1"># Extract the sinusoidal component with the maximum amplitude
</span>        <span class="n">component</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_max</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="nf">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">components</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        
        <span class="c1"># Remove the extracted component from the residual signal
</span>        <span class="n">r</span> <span class="o">-=</span> <span class="n">component</span>
        
    <span class="c1"># Return the extracted components
</span>    <span class="k">return</span> <span class="n">components</span>

</code></pre></div></div><h3 id="the-brief-theory-foundation-of-afd">The Brief Theory Foundation of AFD</h3><p>AFD was motivated by the fact that Gaborâ€™s [12] method does not always produce analytic signals of non-negative instantaneous frequency (IF) [13]. To stick on the analytic signal idea, one has to accept that not all analytic signals have non-negative analytic phase derivative, or IF. This suggests seeking ways to approximate the given signal by appropriate basic signal with non-negative analytic IF, viz., monocomponents [13]. Progress has been made along this direction in which AFD is a core concept in the theory and practice. The brief explanation of AFD is provided below.</p><p>AFD decomposes any given analytic signal of finite energy into a linear combination of a type of basic normal mono-component signals called modified Blaschke products. For a real-valued signal $f$ defined on the unit circle, AFD is to be applied to its Hardy space projection \(f^{+}=\frac{1}{2}(f+i H f)+\frac{c_0}{2},\) where $H f$ is the circular Hilbert transform of $f$ with the formula \(f^{+}\left(e^{i t}\right)=\sum_{k=1}^{\infty}&lt;f_k, e_{a_k}&gt;B_k\left(e^{i t}\right),\) where \(\begin{aligned} &amp; e_{a_k}\left(e^{i t}\right)=\frac{\sqrt{1-\left|a_k\right|^2}}{1-\bar{a}_k e^{i t}}, \\ &amp; a_k=\operatorname{argmax}\left\{\sqrt{1-|b|^2}\left|f_k(b)\right|: b \in \text { the unit disc }\right\} \\ &amp; B_k\left(e^{i t}\right)=e_{a_k}\left(e^{i t}\right) \prod_{l=1}^{k-1} \frac{e^{i t}-a_l}{1-\bar{a}_l e^{i t}}, \\ &amp; f_k\left(e^{i t}\right)=\frac{f_{k-1}\left(e^{i t}\right)-&lt;f_{k-1}, e_{a_{k-1}}&gt;e_{a_{k-1}}\left(e^{i t}\right)}{\frac{e^{i t}-a_{k-1}}{1-\bar{a}_{k-1} e^t}}, k=1,2, \cdots \\ &amp; f_0=f^{+} . \end{aligned}\) The algorithm stops at the step $N$ such that \(\left\|f^{+}\right\|-\sum_{k=1}^N\left(1-\left|a_k\right|^2\right)\left|f_k\left(a_k\right)\right|^2&lt;\varepsilon\) for the first time. The approximation to the original realvalued function $f$ is \(f=2 \operatorname{Re}\left\{\sum_{k=1}^N&lt;f_k, e_{a_k}&gt;B_k\right\}-c_0\)</p><p>\(=\sum_{k=1}^N \rho_k(t) \cos \theta_k(t)-c_0\) where \(\begin{aligned} &amp; \rho_k(t) e^{i \theta_k(t)}=2&lt;f_k, e_{a_k}&gt;B_k\left(e^{i t}\right) \\ &amp; c_0=\frac{1}{2 \pi} \int_0^{2 \pi} f\left(e^{i t}\right) d t . \end{aligned}\) Practically we take the initial value $a_1=0$. This article makes use the open algorithm code in the homepage of Qian: http://www.fst.umac.mo/en/staff/ fsttq.html. There are three AFD algorithms. The algorithm used in this paper is Cyclic AFD.</p><hr> <side style="font-size: 0.9em"><h3 style="margin-bottom: 1em">Notes mentioning this note</h3><div style="font-size: 0.9em"><p> There are no notes linking to this note.</p></div></side> <a href="" class="post-link"><h2></h2><p class="post-excerpt"></p></a> <script src="https://giscus.app/client.js" data-repo="pavandonthireddy/pavandonthireddy.github.io" data-repo-id="[ENTER REPO ID HERE]" data-category="[ENTER CATEGORY NAME HERE]" data-category-id="[ENTER CATEGORY ID HERE]" data-mapping="url" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="light_high_contrast" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></section></main></body></html>
